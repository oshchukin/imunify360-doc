(window.webpackJsonp=window.webpackJsonp||[]).push([[29],{395:function(t,e,a){"use strict";a.r(e);var s=a(35),n=Object(s.a)({},function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[a("h1",{attrs:{id:"faq-and-known-issues"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#faq-and-known-issues","aria-hidden":"true"}},[t._v("#")]),t._v(" FAQ and Known Issues")]),t._v(" "),a("p"),a("div",{staticClass:"table-of-contents"},[a("ul",[a("li",[a("a",{attrs:{href:"#common-questions"}},[t._v("Common Questions")]),a("ul",[a("li",[a("a",{attrs:{href:"#_1-end-user-ip-is-blocked-and-i-do-not-know-why"}},[t._v("1. End user IP is blocked and I do not know why")])]),a("li",[a("a",{attrs:{href:"#_2-could-i-disable-iptables-firewall-or-ossec-when-using-imunify360"}},[t._v("2. Could I disable IPtables (firewall) or OSSEC, when using Imunify360?")])]),a("li",[a("a",{attrs:{href:"#_3-does-imunify360-log-events-such-as-adding-or-removing-an-ip-to-from-the-gray-list"}},[t._v("3. Does Imunify360 log events such as adding or removing an IP to/from the Gray List?")])]),a("li",[a("a",{attrs:{href:"#_5-to-start-using-imunify360-we-need-to-know-which-information-is-sent-to-your-servers-could-you-please-give-us-some-more-information"}},[t._v("5. To start using Imunify360 we need to know which information is sent to your servers. Could you please give us some more information?")])]),a("li",[a("a",{attrs:{href:"#_6-no-valid-imunify360-license-found"}},[t._v("6. No valid Imunify360 License Found.")])]),a("li",[a("a",{attrs:{href:"#_7-i-have-an-error-peewee-databaseerror-database-disk-image-is-malformed-what-should-i-do"}},[t._v("7. I have an error peewee.DatabaseError: database disk image is malformed. What should I do?")])]),a("li",[a("a",{attrs:{href:"#_8-why-does-my-cpanel-with-litespeed-and-owasp-modsecurity-rule-set-trigger-500-error-on-all-web-pages-after-installing-imunify360"}},[t._v("8. Why does my cPanel with LiteSpeed and OWASP ModSecurity rule set trigger 500 error on all web pages after installing Imunify360?")])]),a("li",[a("a",{attrs:{href:"#_9-disabling-waf-rules-for-certain-countries"}},[t._v("9. Disabling WAF rules for certain countries.")])]),a("li",[a("a",{attrs:{href:"#_10-how-to-clone-imnify360-configuration-on-another-system"}},[t._v("10. How to clone Imnify360 configuration on another system?")])]),a("li",[a("a",{attrs:{href:"#_11-how-to-disable-support-icon-in-the-imunify360-ui"}},[t._v("11. How to disable Support icon in the Imunify360 UI?")])]),a("li",[a("a",{attrs:{href:"#_12-how-to-hide-the-ignore-list-tab-for-end-users-in-the-imunify360-ui"}},[t._v("12. How to hide the Ignore List tab for end users in the Imunify360 UI?")])]),a("li",[a("a",{attrs:{href:"#_13-how-to-delete-malware-scan-results-from-imunify360-s-database"}},[t._v("13. How to delete malware scan results from Imunify360’s database?")])]),a("li",[a("a",{attrs:{href:"#_14-imunify360-webshield-could-not-allocate-memory-problem-how-to-fix"}},[t._v("14. Imunify360 WebShield ‘Could not allocate memory’ problem. How to fix?")])]),a("li",[a("a",{attrs:{href:"#_15-how-to-check-modsecurity-scan-works"}},[t._v('15. How to check "ModSecurity scan" works?')])]),a("li",[a("a",{attrs:{href:"#_16-how-to-check-automatically-scan-all-modified-files-works"}},[t._v('16. How to check "automatically scan all modified files" works?')])]),a("li",[a("a",{attrs:{href:"#_17-malware-file-reasons"}},[t._v("17. Malware file reasons")])]),a("li",[a("a",{attrs:{href:"#_18-can-imunify360-firewall-block-traffic-by-domain-name"}},[t._v("18. Can Imunify360 firewall block traffic by domain name?")])]),a("li",[a("a",{attrs:{href:"#_19-what-ports-are-used-by-webshield"}},[t._v("19. What ports are used by WebShield?")])]),a("li",[a("a",{attrs:{href:"#_20-where-can-i-find-the-quarantined-files"}},[t._v("20. Where can I find the quarantined files?")])]),a("li",[a("a",{attrs:{href:"#_21-how-to-check-that-captcha-works"}},[t._v("21. How to check that CAPTCHA works?")])]),a("li",[a("a",{attrs:{href:"#_22-how-to-edit-watched-and-excluded-patterns-for-malware-scanner-badge-text-v-4-8"}},[t._v("22. How to edit watched and excluded patterns for Malware Scanner? "),a("Badge",{attrs:{text:"v.4.8"}})],1)]),a("li",[a("a",{attrs:{href:"#_23-how-to-test-rules-based-on-modsecurity-tags"}},[t._v("23. How to test rules based on ModSecurity tags?")])]),a("li",[a("a",{attrs:{href:"#_24-imunify-agent-is-not-running-troubleshooting"}},[t._v('24. "Imunify agent is not running" troubleshooting')])])])]),a("li",[a("a",{attrs:{href:"#corner-cases"}},[t._v("Corner cases")]),a("ul",[a("li",[a("a",{attrs:{href:"#ip-whitelisting-port-blocking-precedence"}},[t._v("IP whitelisting/port blocking precedence")])])])]),a("li",[a("a",{attrs:{href:"#plesk-related"}},[t._v("Plesk related")]),a("ul",[a("li",[a("a",{attrs:{href:"#how-to-get-an-imunify-activation-key-from-the-extended-plesk-license"}},[t._v("How to get an Imunify activation key from the extended Plesk license")])])])])])]),a("p"),t._v(" "),a("h2",{attrs:{id:"common-questions"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#common-questions","aria-hidden":"true"}},[t._v("#")]),t._v(" Common Questions")]),t._v(" "),a("h3",{attrs:{id:"_1-end-user-ip-is-blocked-and-i-do-not-know-why"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1-end-user-ip-is-blocked-and-i-do-not-know-why","aria-hidden":"true"}},[t._v("#")]),t._v(" 1. End user IP is blocked and I do not know why")]),t._v(" "),a("p",[t._v("If you use CSF, then try to find the IP in "),a("RouterLink",{attrs:{to:"/ids_integration/#csf-integration"}},[t._v("CSF")]),t._v(" "),a("span",{staticClass:"notranslate"},[t._v("Allow/Deny")]),t._v(" Lists using their "),a("a",{attrs:{href:"https://support.configserver.com/knowledgebase/category/support%20",target:"_blank",rel:"noopener noreferrer"}},[t._v("documentation and support"),a("OutboundLink")],1),t._v(". If not, then do the following:")],1),t._v(" "),a("ul",[a("li",[a("p",[t._v("Go to cPanel Plugins section, choose Imunify360 and enter the "),a("span",{staticClass:"notranslate"},[t._v("Incidents")]),t._v(" page.")])]),t._v(" "),a("li",[a("p",[t._v("Make sure that the IP checkbox at the top of the table is ticked. Enter proper IP or part of IP in the input field and click "),a("em",[t._v("Enter")]),t._v(".")]),t._v(" "),a("ul",[a("li",[t._v("If the IP was found, then follow instructions on "),a("RouterLink",{attrs:{to:"/dashboard/#incidents"}},[t._v("Incidents page")]),t._v(" and perform the actions you need, like: add IP to the "),a("span",{staticClass:"notranslate"},[t._v("White List")]),t._v(" or disable the security rule that has detected this incident.")],1)])]),t._v(" "),a("li",[a("p",[t._v("If the IP was not found on the Incidents page, then go to Firewall page and using the same way as in the previous step try to find proper IP in "),a("span",{staticClass:"notranslate"},[t._v("Black List")]),t._v(" or "),a("span",{staticClass:"notranslate"},[t._v("Grey List")]),t._v(".")]),t._v(" "),a("ul",[a("li",[t._v("If the IP was found then follow this instruction for "),a("span",{staticClass:"notranslate"},[a("RouterLink",{attrs:{to:"/dashboard/#firewall"}},[t._v("Grey List")])],1),t._v(" or "),a("span",{staticClass:"notranslate"},[a("RouterLink",{attrs:{to:"/dashboard/#firewall"}},[t._v("Black List")])],1),t._v(" and move the IP to the "),a("span",{staticClass:"notranslate"},[t._v("White List")]),t._v(" or just remove from the "),a("span",{staticClass:"notranslate"},[t._v("Black List")]),t._v(" or "),a("span",{staticClass:"notranslate"},[t._v("Grey List")]),t._v(".")])])])]),t._v(" "),a("p",[t._v("If nothing helps, then "),a("a",{attrs:{href:"https://cloudlinux.zendesk.com/hc/requests/new",target:"_blank",rel:"noopener noreferrer"}},[t._v("contact our support team"),a("OutboundLink")],1),t._v(".")]),t._v(" "),a("div",{staticClass:"tip custom-block"},[a("p",{staticClass:"custom-block-title"},[t._v("Note")]),a("p",[t._v("There is a corner case of "),a("RouterLink",{attrs:{to:"/faq_and_known_issues/#ip-whitelisting-port-blocking-precedence"}},[t._v("IP whitelisting/port blocking precedence")])],1)]),a("h3",{attrs:{id:"_2-could-i-disable-iptables-firewall-or-ossec-when-using-imunify360"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2-could-i-disable-iptables-firewall-or-ossec-when-using-imunify360","aria-hidden":"true"}},[t._v("#")]),t._v(" 2. Could I disable IPtables (firewall) or OSSEC, when using Imunify360?")]),t._v(" "),a("p",[t._v("No. Imunify360 will not be able to stop an attack without IPtables and will not be able to detect an attack without OSSEC.")]),t._v(" "),a("h3",{attrs:{id:"_3-does-imunify360-log-events-such-as-adding-or-removing-an-ip-to-from-the-gray-list"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_3-does-imunify360-log-events-such-as-adding-or-removing-an-ip-to-from-the-gray-list","aria-hidden":"true"}},[t._v("#")]),t._v(" 3. Does Imunify360 log events such as adding or removing an IP to/from the Gray List?")]),t._v(" "),a("p",[t._v("Most Imunify360 logs are saved in "),a("span",{staticClass:"notranslate"},[a("code",[t._v("/var/log/imunify360/console.log")])]),t._v(". For example, when IP is blocked and added to the "),a("span",{staticClass:"notranslate"},[t._v("Black List")]),t._v(", the following lines are added:")]),t._v(" "),a("div",{staticClass:"notranslate"},[a("div",{staticClass:"language-Python extra-class"},[a("pre",{pre:!0,attrs:{class:"language-python"}},[a("code",[t._v("INFO "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("2017")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("04")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("15")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("18")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("30")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("00")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("889")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\ndefence360agent"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("plugins"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("protector"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("lazy_init"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" IP "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("103.86")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v(".52")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v(".175")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("is")]),t._v(" BLOCKED\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("with")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("300")]),t._v(" sec "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("expiration"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1492281300")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("due to SensorAlert"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\nINFO "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("2017")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("04")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("15")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("18")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("30")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("00")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("889")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\ndefence360agent"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("plugins"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("protector"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("lazy_init"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" Unblocking "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("103.86")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v(".52")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v(".175")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("in")]),t._v("\nCSF "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("as")]),t._v(" it "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("is")]),t._v(" already "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("in")]),t._v(" our graylist\nINFO "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("2017")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("04")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("15")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("18")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("30")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("01")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("663")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" defence360agent"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("internals"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("the_sink"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\nSensorAlert"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'rule_id'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'LF_SMTPAUTH'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'timestamp'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1492281000.8720655")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'attackers_ip'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'103.86.52.175'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'plugin_id'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'lfd'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'method'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'ALERT'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'ttl'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'1'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\nWhen user unblocks himself by captcha"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" logs look like this"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\nINFO "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("2017")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("04")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("17")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("00")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("51")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("26")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("956")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" defence360agent"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("internals"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("the_sink"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\nCaptchaEvent"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'timestamp'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1492404686.9496775")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'errors'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'user_agent'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/56.0.2924.87 Safari/537.36'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'accept_language'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'ru-RU,ru;q=0.8,en-US;q=0.6,en;q=0.4'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'event'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'PASSED'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'method'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'CAPTCHA'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'attackers_ip'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'10.101.1.18'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\nINFO "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("2017")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("04")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("17")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("00")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("51")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("26")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("967")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\ndefence360agent"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("plugins"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("protector"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("lazy_init"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" IP "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("10.101")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v(".1")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v(".18")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("is")]),t._v(" UNBLOCKED\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("due to ClientUnblock"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])])]),t._v(" "),a("p",[t._v("Adding and removing IPs from the "),a("span",{staticClass:"notranslate"},[t._v("White List")]),t._v(" is only possible manually, no IPs will be added automatically.")]),t._v(" "),a("h3",{attrs:{id:"_5-to-start-using-imunify360-we-need-to-know-which-information-is-sent-to-your-servers-could-you-please-give-us-some-more-information"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_5-to-start-using-imunify360-we-need-to-know-which-information-is-sent-to-your-servers-could-you-please-give-us-some-more-information","aria-hidden":"true"}},[t._v("#")]),t._v(" 5. To start using Imunify360 we need to know which information is sent to your servers. Could you please give us some more information?")]),t._v(" "),a("p",[t._v("The following info is sent to our server:")]),t._v(" "),a("ul",[a("li",[t._v("all the messages from IDS OSSEC (can be found in OSSEC logs)")]),t._v(" "),a("li",[t._v("all the messages from "),a("span",{staticClass:"notranslate"},[t._v("mod_security")]),t._v(" (can be found in "),a("span",{staticClass:"notranslate"},[a("code",[t._v("modsec_audit.log")])]),t._v(")")]),t._v(" "),a("li",[t._v("users domains (to be checked in reputation engine);")]),t._v(" "),a("li",[t._v("CAPTCHA verification info")]),t._v(" "),a("li",[t._v("all running scans for malware (maldet scans) and information on moving to the quarantine or discovering suspicious files")]),t._v(" "),a("li",[t._v("optionally, suspicious files can be sent to us for the analysis. Files can be sent via UI by marking a proper checkbox")])]),t._v(" "),a("h3",{attrs:{id:"_6-no-valid-imunify360-license-found"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_6-no-valid-imunify360-license-found","aria-hidden":"true"}},[t._v("#")]),t._v(" 6. No valid Imunify360 License Found.")]),t._v(" "),a("p",[t._v("Check if the agent is running.")]),t._v(" "),a("p",[t._v("Check access to the central server ("),a("span",{staticClass:"notranslate"},[a("code",[t._v("IP: 148.251.130.176 port: 443)")])]),t._v(".")]),t._v(" "),a("p",[t._v("Call "),a("span",{staticClass:"notranslate"},[a("code",[t._v("imunify360-agent rstatus")])]),t._v(" and ensure that status is "),a("span",{staticClass:"notranslate"},[a("code",[t._v("True")])]),t._v(":")]),t._v(" "),a("div",{staticClass:"notranslate"},[a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v("{'expiration': 0, 'status': True, 'user_count': None, 'user_limit': None, 'redirect_url': None}\n")])])])]),t._v(" "),a("p",[t._v("Ensure that "),a("span",{staticClass:"notranslate"},[a("code",[t._v("/etc/sysconfig/imunify360/imunify360.id")])]),t._v(" file contains "),a("span",{staticClass:"notranslate"},[a("code",[t._v("server_id")])]),t._v(".")]),t._v(" "),a("p",[t._v("If no, "),a("span",{staticClass:"notranslate"},[a("code",[t._v("imunify360-agent register KEY")])]),t._v(".")]),t._v(" "),a("h3",{attrs:{id:"_7-i-have-an-error-peewee-databaseerror-database-disk-image-is-malformed-what-should-i-do"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_7-i-have-an-error-peewee-databaseerror-database-disk-image-is-malformed-what-should-i-do","aria-hidden":"true"}},[t._v("#")]),t._v(" 7. I have an error peewee.DatabaseError: database disk image is malformed. What should I do?")]),t._v(" "),a("p",[t._v("Imunify360 uses SQLite database to store its data. Although this database has proved its reliability, database files become corrupted in rare cases. To restore data try to perform the following steps:")]),t._v(" "),a("p",[t._v("Stop the agent.")]),t._v(" "),a("p",[t._v("If you have sqlite3 application installed on your machine, try to make dump of Imunify360 database:")]),t._v(" "),a("div",{staticClass:"notranslate"},[a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v("#sqlite3 /var/imunify360/imunify360.db\n.mode insert\n.output dump_all.sql\n.dump\n.exit\n")])])])]),t._v(" "),a("p",[t._v("You should see new file "),a("span",{staticClass:"notranslate"},[a("code",[t._v("dump_all.sql")])]),t._v(" in the directory "),a("span",{staticClass:"notranslate"},[a("code",[t._v("/var/imunify/")])])]),t._v(" "),a("p",[t._v("Create a new database from this dump file:")]),t._v(" "),a("div",{staticClass:"notranslate"},[a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v("#sqlite3 imunify360.db.new < dump_all.sql\n")])])])]),t._v(" "),a("p",[t._v("Replace old database with the new one:")]),t._v(" "),a("div",{staticClass:"notranslate"},[a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v("#cd /var/imunify/\n#mv imunify360.db imunify360.db.corrupt && mv imunify360.db.new imunify360.db\n")])])])]),t._v(" "),a("p",[t._v("Start the Imunify360 agent.")]),t._v(" "),a("p",[t._v("If these steps have not solved the problem or no sqlite3 package is installed, then you should create a completely new database:")]),t._v(" "),a("p",[t._v("Stop the agent.")]),t._v(" "),a("div",{staticClass:"notranslate"},[a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v("#rm /var/imunify/imunify360.db\n#imunify360-agent migratedb\n")])])])]),t._v(" "),a("p",[t._v("Start the agent")]),t._v(" "),a("h3",{attrs:{id:"_8-why-does-my-cpanel-with-litespeed-and-owasp-modsecurity-rule-set-trigger-500-error-on-all-web-pages-after-installing-imunify360"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_8-why-does-my-cpanel-with-litespeed-and-owasp-modsecurity-rule-set-trigger-500-error-on-all-web-pages-after-installing-imunify360","aria-hidden":"true"}},[t._v("#")]),t._v(" 8. Why does my cPanel with LiteSpeed and OWASP ModSecurity rule set trigger 500 error on all web pages after installing Imunify360?")]),t._v(" "),a("p",[t._v("OWASP rule set may conflict with Imunify360 default rule set on a server running "),a("span",{staticClass:"notranslate"},[t._v("LiteSpeed Web Server")]),t._v(". We recommend to turn off OWASP rule set prior to installing Imunify360.")]),t._v(" "),a("p",[t._v("Please find more FAQs in our "),a("a",{attrs:{href:"https://cloudlinux.zendesk.com/hc/sections/360003635400-FAQ",target:"_blank",rel:"noopener noreferrer"}},[t._v("Knowledge Base"),a("OutboundLink")],1),t._v(".")]),t._v(" "),a("h3",{attrs:{id:"_9-disabling-waf-rules-for-certain-countries"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_9-disabling-waf-rules-for-certain-countries","aria-hidden":"true"}},[t._v("#")]),t._v(" 9. Disabling WAF rules for certain countries.")]),t._v(" "),a("p",[t._v("It is possible to disable some WAF rules for IPs that are resolved to be from some country (or other geographical entity).\nTo implement this, a customer should create his own modsecurity configuration file, and include it into the default modsecurity configuration. In case of cPanel, this can be done by creating "),a("span",{staticClass:"notranslate"},[a("code",[t._v("/etc/apache2/conf.d/includes/countrywafrules.conf")])]),t._v(" and adding it as an include to the "),a("span",{staticClass:"notranslate"},[a("code",[t._v("/etc/apache2/conf.d/modsec/modsec2.cpanel.conf")])]),t._v(". Otherwise configuration files might be rewritten by Imunify360 rules update.")]),t._v(" "),a("p",[t._v("Example of contents of such config file:")]),t._v(" "),a("div",{staticClass:"notranslate"},[a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v('SecGeoLookupDb /path/to/GeoLiteCity.dat \n# ModSecurity relies on the free geolocation databases (GeoLite City and GeoLite Country) that can be obtained from MaxMind http://www.maxmind.com. Currently ModSecurity only supports the legacy GeoIP format. Maxmind\'s newer GeoIP2 format is not yet currently supported.\nSo a customer need to download this IP database and locate somewhere.\n\n# Lookup IP address \nSecRule REMOTE_ADDR "@geoLookup" "phase:1,id:155,nolog,pass"\n\n# Optionally block IP address for which geolocation failed\n# SecRule &GEO "@eq 0" "phase:1,id:156,deny,msg:\'Failed to lookup IP\'"\n\n# Skip rules 942100 and 942101 for GB country as example\n\nSecRule GEO:COUNTRY_CODE "@streq GB" "phase:2,auditlog,id:157,pass,severity:2,\\\nctl:ruleRemoveById=942100,\\\nctl:ruleRemoveById=942101"\n')])])])]),t._v(" "),a("p",[t._v("Make sure that you have replaced "),a("span",{staticClass:"notranslate"},[a("code",[t._v("/path/to/GeoLiteCity.dat")])]),t._v(" with the real path to the GeoLiteCity.dat file installed in your system.")]),t._v(" "),a("p",[t._v("Variable "),a("span",{staticClass:"notranslate"},[a("code",[t._v("GEO")])]),t._v(" is a collection populated by result of the last "),a("span",{staticClass:"notranslate"},[a("code",[t._v("@geoLookup")])]),t._v(" operator. The collection can be used to match geographical fields looked from an IP address or hostname.")]),t._v(" "),a("div",{staticClass:"tip custom-block"},[a("p",{staticClass:"custom-block-title"},[t._v("Note")]),a("p",[t._v("Available since ModSecurity 2.5.0.")])]),a("p",[t._v("Fields:")]),t._v(" "),a("ul",[a("li",[a("span",{staticClass:"notranslate"},[a("code",[t._v("COUNTRY_CODE")])]),t._v(": two character country code. Example: "),a("code",[t._v("US")]),t._v(", "),a("code",[t._v("GB")]),t._v(", etc.")]),t._v(" "),a("li",[a("span",{staticClass:"notranslate"},[a("code",[t._v("COUNTRY_CODE3")])]),t._v(": up to three character country code.")]),t._v(" "),a("li",[a("span",{staticClass:"notranslate"},[a("code",[t._v("COUNTRY_NAME")])]),t._v(": full country name.")]),t._v(" "),a("li",[a("span",{staticClass:"notranslate"},[a("code",[t._v("COUNTRY_CONTINENT")])]),t._v(": two character continent that the country is located. Example: "),a("code",[t._v("EU")]),t._v(".")]),t._v(" "),a("li",[a("span",{staticClass:"notranslate"},[a("code",[t._v("REGION")])]),t._v(": two character region. For US, this is state. For Canada, providence, etc.")]),t._v(" "),a("li",[a("span",{staticClass:"notranslate"},[a("code",[t._v("CITY")])]),t._v(": city name if supported by the database.")]),t._v(" "),a("li",[a("span",{staticClass:"notranslate"},[a("code",[t._v("POSTAL_CODE")])]),t._v(": postal code if supported by the database.")]),t._v(" "),a("li",[a("span",{staticClass:"notranslate"},[a("code",[t._v("LATITUDE")])]),t._v(": latitude if supported by the database.")]),t._v(" "),a("li",[a("span",{staticClass:"notranslate"},[a("code",[t._v("LONGITUDE")])]),t._v(": longitude if supported by the database.")]),t._v(" "),a("li",[a("span",{staticClass:"notranslate"},[a("code",[t._v("DMA_CODE")])]),t._v(": metropolitan area code if supported by the database. (US only)")]),t._v(" "),a("li",[a("span",{staticClass:"notranslate"},[a("code",[t._v("AREA_CODE")])]),t._v(": phone system area code. (US only)")])]),t._v(" "),a("h3",{attrs:{id:"_10-how-to-clone-imnify360-configuration-on-another-system"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_10-how-to-clone-imnify360-configuration-on-another-system","aria-hidden":"true"}},[t._v("#")]),t._v(" 10. How to clone Imnify360 configuration on another system?")]),t._v(" "),a("p",[t._v("The solution is available in "),a("a",{attrs:{href:"https://cloudlinux.zendesk.com/hc/en-us/articles/360022689394-How-to-Clone-Imunify360-Installation",target:"_blank",rel:"noopener noreferrer"}},[t._v("FAQ section"),a("OutboundLink")],1)]),t._v(" "),a("h3",{attrs:{id:"_11-how-to-disable-support-icon-in-the-imunify360-ui"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_11-how-to-disable-support-icon-in-the-imunify360-ui","aria-hidden":"true"}},[t._v("#")]),t._v(" 11. How to disable Support icon in the Imunify360 UI?")]),t._v(" "),a("ol",[a("li",[t._v("Go to "),a("span",{staticClass:"notranslate"},[a("code",[t._v("/etc/sysconfig/imunify360/imunify360.config")])]),t._v(".")]),t._v(" "),a("li",[t._v("And set "),a("span",{staticClass:"notranslate"},[a("code",[t._v("PERMISSIONS.support_form:")])]),t._v(" option to "),a("span",{staticClass:"notranslate"},[a("code",[t._v("false")])]),t._v(".")])]),t._v(" "),a("p",[t._v("OR, "),a("strong",[t._v("better")]),t._v(", run the following command:")]),t._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v('imunify360-agent config update \'{"PERMISSIONS": {"support_form": false}}\'\n')])])]),a("h3",{attrs:{id:"_12-how-to-hide-the-ignore-list-tab-for-end-users-in-the-imunify360-ui"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_12-how-to-hide-the-ignore-list-tab-for-end-users-in-the-imunify360-ui","aria-hidden":"true"}},[t._v("#")]),t._v(" 12. How to hide the Ignore List tab for end users in the Imunify360 UI?")]),t._v(" "),a("ol",[a("li",[t._v("Go to "),a("span",{staticClass:"notranslate"},[a("code",[t._v("/etc/sysconfig/imunify360/imunify360.config")])]),t._v(".")]),t._v(" "),a("li",[t._v("And set "),a("span",{staticClass:"notranslate"},[a("code",[t._v("PERMISSIONS.user_ignore_list:")])]),t._v(" option to "),a("span",{staticClass:"notranslate"},[a("code",[t._v("false")])]),t._v(".")])]),t._v(" "),a("p",[t._v("OR, "),a("strong",[t._v("better")]),t._v(", run the following command:")]),t._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v('imunify360-agent config update \'{"PERMISSIONS": {"user_ignore_list": false}}\'\n')])])]),a("h3",{attrs:{id:"_13-how-to-delete-malware-scan-results-from-imunify360-s-database"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_13-how-to-delete-malware-scan-results-from-imunify360-s-database","aria-hidden":"true"}},[t._v("#")]),t._v(" 13. How to delete malware scan results from Imunify360’s database?")]),t._v(" "),a("p",[t._v("Sometimes, you may need to delete all users’ scan results from the server. This should not be common practice, and we do not recommend doing it on a regular basis. But, if you do need to erase the results of all Imunify360 scans, you can find the instructions below.")]),t._v(" "),a("ol",[a("li",[t._v("First, you need to stop the agent:")])]),t._v(" "),a("div",{staticClass:"notranslate"},[a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v("systemctl stop imunify360\n")])])])]),t._v(" "),a("p",[t._v("(on CentOS 7)\n")]),a("div",{staticClass:"notranslate"},[a("p"),t._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v("service imunify360 stop\n")])])])]),t._v(" "),a("p",[t._v("(on CentOS 6, Ubuntu)")]),t._v(" "),a("ol",{attrs:{start:"2"}},[a("li",[t._v("Connect to the Imunify360 database by running this command:")])]),t._v(" "),a("div",{staticClass:"notranslate"},[a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v("sqlite3 /var/imunify360/imunify360.db\n")])])])]),t._v(" "),a("ol",{attrs:{start:"3"}},[a("li",[t._v("Execute the following SQL commands:")])]),t._v(" "),a("div",{staticClass:"danger custom-block"},[a("p",{staticClass:"custom-block-title"},[t._v("IMPORTANT")]),a("p",[t._v("This will remove all scan results from Imunify360!")])]),a("div",{staticClass:"notranslate"},[a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v("DELETE FROM malware_history;\nDELETE FROM malware_hits;\nDELETE FROM malware_scans;\nDELETE FROM malware_user_infected;\n")])])])]),t._v(" "),a("ol",{attrs:{start:"4"}},[a("li",[t._v("Start the Imunify360 service:")])]),t._v(" "),a("div",{staticClass:"notranslate"},[a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v("systemctl start imunify360\n")])])])]),t._v(" "),a("p",[t._v("(on CentOS 7)\n")]),a("div",{staticClass:"notranslate"},[a("p"),t._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v("service imunify360 start\n")])])])]),t._v(" "),a("p",[t._v("(on CentOS 6, Ubuntu)")]),t._v(" "),a("p",[t._v("We don’t recommend cleaning the scan results for specific users, as it may cause inconsistencies in the "),a("span",{staticClass:"notranslate"},[a("code",[t._v("malware_scans")])]),t._v(" table. But, in emergencies, you can do it with these SQL commands:")]),t._v(" "),a("div",{staticClass:"notranslate"},[a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v("DELETE FROM malware_history WHERE file_onwer = <user>;\nDELETE FROM malware_hits WHERE user = <user>;\nDELETE FROM malware_user_infected WHERE user = <user>;\n")])])])]),t._v(" "),a("p",[t._v("Unfortunately, there’s no easy way to delete records in the "),a("span",{staticClass:"notranslate"},[a("code",[t._v("malware_scans")])]),t._v(" table for a specific user, so the table should be either truncated with the other tables shown in step 2 above, or the records should just be ignored.")]),t._v(" "),a("p",[t._v("If you need any more information on this or anything else related to Imunify360 administration, please "),a("a",{attrs:{href:"mailto:feedback@imunify360.com"}},[t._v("get in touch")]),t._v(" .")]),t._v(" "),a("h3",{attrs:{id:"_14-imunify360-webshield-could-not-allocate-memory-problem-how-to-fix"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_14-imunify360-webshield-could-not-allocate-memory-problem-how-to-fix","aria-hidden":"true"}},[t._v("#")]),t._v(" 14. Imunify360 WebShield ‘Could not allocate memory’ problem. How to fix?")]),t._v(" "),a("p",[a("strong",[t._v("Symptoms:")]),t._v(" It can have pretty different symptoms (increased IO, CPU and memory usage), but the main one is that WebShield blacklisting (through CDN) does not work.")]),t._v(" "),a("p",[a("strong",[t._v("How to check:")]),t._v(" Just browse wsshdict log ("),a("span",{staticClass:"notranslate"},[a("code",[t._v("/var/log/wsshdict/wsshdict.log")])]),t._v("). If you face the issue, the log will have entries like:")]),t._v(" "),a("div",{staticClass:"notranslate"},[a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v("2019-07-09 16:50:06 [WARN]: Could not allocate memory for 192.126.123.115/32 in rbtree\n2019-07-09 16:52:23 [WARN]: Could not allocate memory for 179.108.244.125/32 in lpctrie\n")])])])]),t._v(" "),a("p",[t._v("This means that the shared memory is full and no new address is allowed to be added.\nShared memory has a fixed size (it’s set in configuration files) and cannot change it dynamically. Currently, the size of shared memory is "),a("strong",[t._v("20 MB")]),t._v(", and it can take up to 89k IPv4 addresses. However, some of our clients have more blacklisted addresses, and when Imunify360 agent tries to place all these IP addresses into shared memory, the aforementioned error occurs.")]),t._v(" "),a("p",[a("strong",[t._v("How to fix:")]),t._v(" We want to increase the shared memory size.")]),t._v(" "),a("ol",[a("li",[t._v("Modify the second parameter of the "),a("span",{staticClass:"notranslate"},[a("code",[t._v("shared_storage")])]),t._v(" directive of the "),a("span",{staticClass:"notranslate"},[a("code",[t._v("/etc/imunify360-webshield/webshield.conf")])]),t._v(" config file, to make it look like:")])]),t._v(" "),a("div",{staticClass:"notranslate"},[a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v("shared_storage /opt/imunify360-webshield/shared_data/shdict.dat 21m;\n")])])])]),t._v(" "),a("ol",{attrs:{start:"2"}},[a("li",[a("p",[t._v("Modify the "),a("span",{staticClass:"notranslate"},[a("code",[t._v("data_size")])]),t._v(" directive of the "),a("span",{staticClass:"notranslate"},[a("code",[t._v("/etc/imunify360-webshield/webshield-shdict.conf")])]),t._v(" config file to "),a("code",[t._v("22020096")]),t._v(" (21 MB in bytes: 1024 * 1024 * 21):")])]),t._v(" "),a("li",[a("p",[t._v("Restart "),a("span",{staticClass:"notranslate"},[a("code",[t._v("imunify360-webshield")])]),t._v(":")])])]),t._v(" "),a("div",{staticClass:"notranslate"},[a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v("   systemctl restart imunify360-webshield\n")])])])]),t._v(" "),a("p",[t._v("Or")]),t._v(" "),a("div",{staticClass:"notranslate"},[a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v("   service imunify360-webshield reload\n")])])])]),t._v(" "),a("p",[t._v("The wsshdict daemon is expected to be restarted automatically.")]),t._v(" "),a("ol",{attrs:{start:"4"}},[a("li",[t._v("Make sure the shared memory size is actually changed. Run "),a("span",{staticClass:"notranslate"},[a("code",[t._v("ipcs -m")])]),t._v(" command. It’s expected to have the output like this:")])]),t._v(" "),a("div",{staticClass:"notranslate"},[a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v("# ipcs -m\n------ Shared Memory Segments --------\nkey      shmid   owner    perms   bytes nattch status  \n0x620035c1 4554752  imunify360 600    22020096   4                       \n0x00000000 32769    root       644    80         2\n")])])])]),t._v(" "),a("p",[t._v("The first column must not have zeros (like in the second row), the third column (owner) is expected to be ‘imunify360-webshield’, and size must correspond to values set in the config files (22020096 in our case).")]),t._v(" "),a("h3",{attrs:{id:"_15-how-to-check-modsecurity-scan-works"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_15-how-to-check-modsecurity-scan-works","aria-hidden":"true"}},[t._v("#")]),t._v(' 15. How to check "ModSecurity scan" works?')]),t._v(" "),a("ol",[a("li",[t._v("To verify, if ModSecurity scan works, you can use the following command:")])]),t._v(" "),a("div",{staticClass:"notranslate"},[a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v("curl -v -s -o /dev/null -F 'data=@<path-to-malware-sample>' http://<domain>/\n")])])])]),t._v(" "),a("p",[t._v("You can get a malware sample file on the eicar.org: "),a("a",{attrs:{href:"http://www.eicar.org/",target:"_blank",rel:"noopener noreferrer"}},[t._v("eicar.org"),a("OutboundLink")],1),t._v(".")]),t._v(" "),a("p",[t._v("For instance:")]),t._v(" "),a("div",{staticClass:"notranslate"},[a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v("wget http://www.eicar.org/download/eicar.com.txt -O /tmp/eicar.com.txt\ncurl -v -s -o /dev/null -F 'data=@/tmp/eicar.com.txt' http://mycoolwebsite.net/\n")])])])]),t._v(" "),a("p",[t._v("You can find the results of this attempt in the "),a("span",{staticClass:"notranslate"},[a("em",[t._v("Incidents")])]),t._v(" tab")]),t._v(" "),a("ol",[a("li",[t._v("Also, you can perform the following request which triggers a test rule")])]),t._v(" "),a("div",{staticClass:"notranslate"},[a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v("curl -v http://mycoolwebsite.net//?i360test=88ff0adf94a190b9d1311c8b50fe2891c85af732 \n")])])])]),t._v(" "),a("p",[t._v("And check the Imunify360 console log")]),t._v(" "),a("div",{staticClass:"notranslate"},[a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v("grep 'Testing the work of the i360 ModSecurity rules' /var/log/imunify360/console.log\n")])])])]),t._v(" "),a("h3",{attrs:{id:"_16-how-to-check-automatically-scan-all-modified-files-works"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_16-how-to-check-automatically-scan-all-modified-files-works","aria-hidden":"true"}},[t._v("#")]),t._v(' 16. How to check "automatically scan all modified files" works?')]),t._v(" "),a("p",[t._v('To check "automatically scan all modified files" (i.e inotify scanner), upload a malware sample to some account\'s webroot via SSH and check if it will appear in the '),a("span",{staticClass:"notranslate"},[a("em",[t._v("Malicious")])]),t._v(" tab shortly.")]),t._v(" "),a("p",[t._v("You can get a malware sample file on the "),a("a",{attrs:{href:"http://www.eicar.org/",target:"_blank",rel:"noopener noreferrer"}},[t._v("eicar.org"),a("OutboundLink")],1),t._v(".")]),t._v(" "),a("p",[t._v("Make sure "),a("RouterLink",{attrs:{to:"/dashboard/#malware"}},[t._v("the option is enabled")]),t._v(".")],1),t._v(" "),a("div",{staticClass:"notranslate"},[a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v("wget http://www.eicar.org/download/eicar.com.txt -O /tmp/eicar.com.txt\nscp /tmp/eicar.com.txt  mycooluser@X.Y.Z.A:/var/www/mycooluser/mycoolwebsite_docroot\n")])])])]),t._v(" "),a("p",[t._v("where "),a("span",{staticClass:"notranslate"},[a("code",[t._v("X.Y.Z.A")])]),t._v(" - your server IP address")]),t._v(" "),a("p",[t._v("You can find the results in the "),a("span",{staticClass:"notranslate"},[a("em",[t._v("Malware scanner > Files")])]),t._v(" tab.")]),t._v(" "),a("h3",{attrs:{id:"_17-malware-file-reasons"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_17-malware-file-reasons","aria-hidden":"true"}},[t._v("#")]),t._v(" 17. Malware file reasons")]),t._v(" "),a("p",[t._v("You can see the advanced reason why a file was detected as malicious.")]),t._v(" "),a("p",[t._v("Go to "),a("span",{staticClass:"notranslate"},[t._v("Imunify → Malware Scanner → Files tab → Reason")]),t._v(". See "),a("RouterLink",{attrs:{to:"/dashboard/#files"}},[t._v("Malware Scanner → Files tab")]),t._v(".")],1),t._v(" "),a("p",[t._v("A reason pattern looks like the following:")]),t._v(" "),a("div",{staticClass:"notranslate"},[a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v("<type>-<detected>-<ID>-<file-type>.<mlwcategory>.<mlwclassification>\n")])])])]),t._v(" "),a("table",[a("thead",[a("tr",[a("th"),t._v(" "),a("th")])]),t._v(" "),a("tbody",[a("tr",[a("td",[a("span",{staticClass:"notranslate"},[a("code",[t._v("<type>")])])]),t._v(" "),a("td",[a("code",[t._v("SMW")]),t._v(" – server malware, "),a("code",[t._v("CMW")]),t._v(" – client malware")])]),t._v(" "),a("tr",[a("td",[a("span",{staticClass:"notranslate"},[a("code",[t._v("<detected>")])])]),t._v(" "),a("td",[a("code",[t._v("SA")]),t._v("- stand-alone (file is completely malicious), "),a("code",[t._v("INJ")]),t._v(" – injections (malware is injected to some legitimate file), "),a("code",[t._v("BLKH")]),t._v(" – blackhash")])]),t._v(" "),a("tr",[a("td",[a("span",{staticClass:"notranslate"},[a("code",[t._v("<ID>")])])]),t._v(" "),a("td",[t._v("a signature ID")])]),t._v(" "),a("tr",[a("td",[a("span",{staticClass:"notranslate"},[a("code",[t._v("<file-type>")])])]),t._v(" "),a("td",[t._v("a file type; see "),a("RouterLink",{attrs:{to:"/faq_and_known_issues/#table-1-file-types-and-their-codes"}},[t._v("Table 1")]),t._v(" below")],1)]),t._v(" "),a("tr",[a("td",[a("span",{staticClass:"notranslate"},[a("code",[t._v("<mlwcategory>")])])]),t._v(" "),a("td",[t._v("a malware category, see "),a("RouterLink",{attrs:{to:"/faq_and_known_issues/#table-2-malware-categories"}},[t._v("Table 2")]),t._v(" below")],1)]),t._v(" "),a("tr",[a("td",[a("span",{staticClass:"notranslate"},[a("code",[t._v("<mlwclassification>")])])]),t._v(" "),a("td",[t._v("malware classification; can vary depends on the different cases and signatures; see "),a("RouterLink",{attrs:{to:"/faq_and_known_issues/#table-3-malware-classification"}},[t._v("Table 3")]),t._v(" below")],1)])])]),t._v(" "),a("h4",{attrs:{id:"table-1-file-types-and-their-codes"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#table-1-file-types-and-their-codes","aria-hidden":"true"}},[t._v("#")]),t._v(" Table 1. File types and their codes")]),t._v(" "),a("table",[a("thead",[a("tr",[a("th"),t._v(" "),a("th")])]),t._v(" "),a("tbody",[a("tr",[a("td",[a("strong",[t._v("File types")])]),t._v(" "),a("td",[a("strong",[t._v("Codes")])])]),t._v(" "),a("tr",[a("td",[t._v("Markup language files")]),t._v(" "),a("td",[a("code",[t._v("htm")]),t._v(", "),a("code",[t._v("html")]),t._v(", "),a("code",[t._v("shtml")]),t._v(" ,"),a("code",[t._v("phtml")])])]),t._v(" "),a("tr",[a("td",[t._v("Server config files")]),t._v(" "),a("td",[a("code",[t._v("htaccess")])])]),t._v(" "),a("tr",[a("td",[a("span",{staticClass:"notranslate"},[t._v("JavaScript")]),t._v(" files")]),t._v(" "),a("td",[a("code",[t._v("js")])])]),t._v(" "),a("tr",[a("td",[a("span",{staticClass:"notranslate"},[t._v("Perl")]),t._v(" files")]),t._v(" "),a("td",[a("code",[t._v("pl")])])]),t._v(" "),a("tr",[a("td",[a("span",{staticClass:"notranslate"},[t._v("Python")]),t._v(" files")]),t._v(" "),a("td",[a("code",[t._v("py")])])]),t._v(" "),a("tr",[a("td",[a("span",{staticClass:"notranslate"},[t._v("Ruby")]),t._v(" files")]),t._v(" "),a("td",[a("code",[t._v("rb")])])]),t._v(" "),a("tr",[a("td",[a("span",{staticClass:"notranslate"},[t._v("Cron")]),t._v(" files")]),t._v(" "),a("td",[a("code",[t._v("cron")])])]),t._v(" "),a("tr",[a("td",[a("span",{staticClass:"notranslate"},[t._v("Shell")]),t._v(" scripts")]),t._v(" "),a("td",[t._v("shells in common: "),a("code",[t._v("sh")])])]),t._v(" "),a("tr",[a("td",[t._v("Other server pages")]),t._v(" "),a("td",[a("code",[t._v("Jsp")]),t._v(" ("),a("code",[t._v("asp")]),t._v(","),a("code",[t._v("aspx")]),t._v("), "),a("code",[t._v("vb")])])])])]),t._v(" "),a("h4",{attrs:{id:"table-2-malware-categories"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#table-2-malware-categories","aria-hidden":"true"}},[t._v("#")]),t._v(" Table 2. Malware categories")]),t._v(" "),a("table",[a("thead",[a("tr",[a("th"),t._v(" "),a("th")])]),t._v(" "),a("tbody",[a("tr",[a("td",[a("strong",[t._v("Category")])]),t._v(" "),a("td",[a("strong",[t._v("Explanation")])])]),t._v(" "),a("tr",[a("td",[a("span",{staticClass:"notranslate"},[a("code",[t._v("bkdr")])])]),t._v(" "),a("td",[t._v("Artifacts that help attackers with partial or complete access to victims. Example: web shells")])]),t._v(" "),a("tr",[a("td",[a("span",{staticClass:"notranslate"},[a("code",[t._v("tool")])])]),t._v(" "),a("td",[t._v("Scripts that are uploaded to victim's servers and can be used to perform certain specific actions like file upload, database access, downloaders/droppers, mailers, brute-force scripts, proxy scripts, etc.")])]),t._v(" "),a("tr",[a("td",[a("span",{staticClass:"notranslate"},[a("code",[t._v("exploit")])])]),t._v(" "),a("td",[t._v("Scripts that are uploaded to victim's servers and meant to exploit certain other vulnerabilities or bugs. Example: WordPress/Joomla exploits")])]),t._v(" "),a("tr",[a("td",[a("span",{staticClass:"notranslate"},[a("code",[t._v("spam")])])]),t._v(" "),a("td",[t._v("Files that deliver spam or point end-users towards spammy content. Example: doorway pages, other SEO spam, spam advertisement, injections, etc.")])]),t._v(" "),a("tr",[a("td",[a("span",{staticClass:"notranslate"},[a("code",[t._v("phish")])])]),t._v(" "),a("td",[t._v("Phishing related malware artifacts")])]),t._v(" "),a("tr",[a("td",[a("span",{staticClass:"notranslate"},[a("code",[t._v("miner")])])]),t._v(" "),a("td",[t._v("All sorts of miners go under this category")])]),t._v(" "),a("tr",[a("td",[a("span",{staticClass:"notranslate"},[a("code",[t._v("redi")])])]),t._v(" "),a("td",[t._v("Malware artifacts causing redirects for any sort of malicious reason can be covered under this category")])]),t._v(" "),a("tr",[a("td",[a("span",{staticClass:"notranslate"},[a("code",[t._v("deface")])])]),t._v(" "),a("td",[t._v("Any sort of artifacts that are meant to show off attacker's intentions or to spread a certain message. Example: Defacements, banners, etc.")])])])]),t._v(" "),a("h4",{attrs:{id:"table-3-malware-classification"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#table-3-malware-classification","aria-hidden":"true"}},[t._v("#")]),t._v(" Table 3. Malware classification")]),t._v(" "),a("p",[t._v("The "),a("span",{staticClass:"notranslate"},[a("em",[t._v("Malware classification")])]),t._v(" field is not fixed and may vary depending on the purposes of the malware.")]),t._v(" "),a("p",[t._v("The following table shows the "),a("span",{staticClass:"notranslate"},[a("em",[t._v("Malware classification")])]),t._v(" field examples.")]),t._v(" "),a("table",[a("thead",[a("tr",[a("th"),t._v(" "),a("th")])]),t._v(" "),a("tbody",[a("tr",[a("td",[a("strong",[t._v("Category")])]),t._v(" "),a("td",[a("strong",[t._v("Classification")])])]),t._v(" "),a("tr",[a("td",[a("span",{staticClass:"notranslate"},[a("code",[t._v("bkdr")])])]),t._v(" "),a("td",[a("span",{staticClass:"notranslate"},[a("code",[t._v("wshll")])]),t._v(" for web shells; "),a("span",{staticClass:"notranslate"},[a("code",[t._v("exec")])]),t._v(" for simple command executor injections")])]),t._v(" "),a("tr",[a("td",[a("span",{staticClass:"notranslate"},[a("code",[t._v("tool")])])]),t._v(" "),a("td",[a("span",{staticClass:"notranslate"},[a("code",[t._v("upldr")]),t._v("/"),a("code",[t._v("dwnldr")]),t._v("/"),a("code",[t._v("drpr")])]),t._v(" for uploader/downloader/dropper type of files")])]),t._v(" "),a("tr",[a("td",[a("span",{staticClass:"notranslate"},[a("code",[t._v("exploit")])])]),t._v(" "),a("td",[a("span",{staticClass:"notranslate"},[a("code",[t._v("vuln")]),t._v("/"),a("code",[t._v("joom")]),t._v("/"),a("code",[t._v("wp")])]),t._v(" for vulnerability/Joomla/WordPress")])]),t._v(" "),a("tr",[a("td",[a("span",{staticClass:"notranslate"},[a("code",[t._v("phish")])])]),t._v(" "),a("td",[a("span",{staticClass:"notranslate"},[a("code",[t._v("ecom")]),t._v("/"),a("code",[t._v("bank")]),t._v("/"),a("code",[t._v("edu")])]),t._v(" for mentioning phishing on e-commerce/banking/educational domains")])]),t._v(" "),a("tr",[a("td",[a("span",{staticClass:"notranslate"},[a("code",[t._v("miner")])])]),t._v(" "),a("td",[a("span",{staticClass:"notranslate"},[a("code",[t._v("chive")]),t._v("/"),a("code",[t._v("cimp")]),t._v("/"),a("code",[t._v("cloot")])]),t._v(" for Coinhive/CoinIMP/CryptoLoot")])])])]),t._v(" "),a("h4",{attrs:{id:"example"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#example","aria-hidden":"true"}},[t._v("#")]),t._v(" Example")]),t._v(" "),a("table",[a("thead",[a("tr",[a("th"),t._v(" "),a("th")])]),t._v(" "),a("tbody",[a("tr",[a("td",[a("strong",[t._v("Reason")])]),t._v(" "),a("td",[a("strong",[t._v("Explanation")])])]),t._v(" "),a("tr",[a("td",[a("span",{staticClass:"notranslate"},[a("code",[t._v("SMW-SA-05155-sh.bkdr.wshll")])])]),t._v(" "),a("td",[a("strong",[t._v("type")]),t._v(": server malware ("),a("code",[t._v("SMW")]),t._v(")"),a("br"),a("strong",[t._v("detected")]),t._v(": stand-alone (file is completely malicious) ("),a("code",[t._v("SA")]),t._v(")"),a("br"),a("strong",[t._v("signature ID")]),t._v(": "),a("code",[t._v("05155")]),a("br"),a("strong",[t._v("file type")]),t._v(": shell scripts ("),a("code",[t._v("sh")]),t._v(")"),a("br"),a("strong",[t._v("mlwcategory")]),t._v(": artifacts that help attackers with partial or complete access to victims ("),a("code",[t._v("bkdr")]),t._v(")"),a("br"),a("strong",[t._v("mlwclassification")]),t._v(": web shells ("),a("code",[t._v("wshll")]),t._v(")")])])])]),t._v(" "),a("h3",{attrs:{id:"_18-can-imunify360-firewall-block-traffic-by-domain-name"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_18-can-imunify360-firewall-block-traffic-by-domain-name","aria-hidden":"true"}},[t._v("#")]),t._v(" 18. Can Imunify360 firewall block traffic by domain name?")]),t._v(" "),a("p",[t._v("Unfortunately, Imunify360 does not have such ability.")]),t._v(" "),a("h3",{attrs:{id:"_19-what-ports-are-used-by-webshield"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_19-what-ports-are-used-by-webshield","aria-hidden":"true"}},[t._v("#")]),t._v(" 19. What ports are used by WebShield?")]),t._v(" "),a("p",[t._v("The following ports are reserved:")]),t._v(" "),a("ul",[a("li",[t._v("52223")]),t._v(" "),a("li",[t._v("52224")]),t._v(" "),a("li",[t._v("52227-52235")])]),t._v(" "),a("p",[t._v("You can find additional information in the following config files:")]),t._v(" "),a("div",{staticClass:"notranslate"},[a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v("/etc/imunify360-webshield/ports.conf\n/etc/imunify360-webshield/ssl_ports.conf\n/etc/imunify360-webshield/webshield.conf\n")])])])]),t._v(" "),a("h3",{attrs:{id:"_20-where-can-i-find-the-quarantined-files"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_20-where-can-i-find-the-quarantined-files","aria-hidden":"true"}},[t._v("#")]),t._v(" 20. Where can I find the quarantined files?")]),t._v(" "),a("p",[t._v("You can find the quarantined files in the following directory: "),a("span",{staticClass:"notranslate"},[a("code",[t._v("/home/.imunify.quarantined/USERNAME")])])]),t._v(" "),a("h3",{attrs:{id:"_21-how-to-check-that-captcha-works"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_21-how-to-check-that-captcha-works","aria-hidden":"true"}},[t._v("#")]),t._v(" 21. How to check that CAPTCHA works?")]),t._v(" "),a("p",[t._v("First, remove an IP from the White list:")]),t._v(" "),a("div",{staticClass:"notranslate"},[a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v("# imunify360-agent whitelist ip delete YOUR_IP \n")])])])]),t._v(" "),a("p",[t._v("After that, run the following loop which triggers ModSecurity test rule 5 times in a row that leads to graylisting of the IP due to the sequence of 403 HTTP errors:")]),t._v(" "),a("div",{staticClass:"notranslate"},[a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v("# for i in {1..5} ; do curl -s http://SERVER_IP/?i360test=88ff0adf94a190b9d1311c8b50fe2891c85af732 > /dev/null; echo $i; done\n")])])])]),t._v(" "),a("p",[t._v("Where "),a("span",{staticClass:"notranslate"},[a("code",[t._v("SERVER_IP")])]),t._v(" is the server's IP address where Imunify360 is installed and where you want to check CAPTCHA.")]),t._v(" "),a("p",[t._v("Also, it is possible to use a domain name of a website which "),a("code",[t._v("DNS A")]),t._v(" record is pointed to the server. In other words, which is located on the server, like:")]),t._v(" "),a("div",{staticClass:"notranslate"},[a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v("\n# for i in {1..5} ; do curl -s http://your.cooldomain.net/?i360test=88ff0adf94a190b9d1311c8b50fe2891c85af732 > /dev/null; echo $i; done\n")])])])]),t._v(" "),a("h3",{attrs:{id:"_22-how-to-edit-watched-and-excluded-patterns-for-malware-scanner"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_22-how-to-edit-watched-and-excluded-patterns-for-malware-scanner","aria-hidden":"true"}},[t._v("#")]),t._v(" 22. How to edit watched and excluded patterns for Malware Scanner? "),a("Badge",{attrs:{text:"v.4.8"}})],1),t._v(" "),a("p",[t._v("Starting from Imunify version 4.8 you can edit watched and excluded patterns for Malware Scanner.")]),t._v(" "),a("p",[t._v("There are two files:")]),t._v(" "),a("ul",[a("li",[a("span",{staticClass:"notranslate"},[a("code",[t._v("/etc/sysconfig/imunify360/malware-filters-admin-conf/watched.txt")])]),t._v(" defines which paths are watched by Imunify360")]),t._v(" "),a("li",[a("span",{staticClass:"notranslate"},[a("code",[t._v("/etc/sysconfig/imunify360/malware-filters-admin-conf/ignored.txt")])]),t._v(" defines which paths are excluded by Imunify360")])]),t._v(" "),a("div",{staticClass:"tip custom-block"},[a("p",{staticClass:"custom-block-title"},[t._v("Note")]),a("p",[t._v("This exclude list is intended for things like logs, tmp files, etc. Things that are not worth scanning in real-time and should not be allowed to execute.\nProactive Defense will prevent "),a("span",{staticClass:"notranslate"},[a("code",[t._v("include")]),t._v("/"),a("code",[t._v("require")])]),t._v(" of PHP files that are excluded by realtime-scan.\nThere is a separate ignore list for false-positive hits: see "),a("RouterLink",{attrs:{to:"/dashboard/#ignore-list"}},[t._v("Ignore List")])],1)]),a("p",[t._v("The "),a("code",[t._v("watched.txt")]),t._v(" file contains additional shell-like glob patterns specifying what file system directories should be monitored by inotify/fanotify realtime scanner.")]),t._v(" "),a("p",[t._v("Patterns can be absolute:")]),t._v(" "),a("div",{staticClass:"notranslate"},[a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v("/another/folder\n")])])])]),t._v(" "),a("p",[t._v('or relative to basedirs supplied by hosting control panels, if they start with a "+" sign:"')]),t._v(" "),a("div",{staticClass:"notranslate"},[a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v("+*/www\n")])])])]),t._v(" "),a("p",[t._v("This relative pattern will expand to the "),a("code",[t._v("/home/*/www")]),t._v(" for cPanel, for example.")]),t._v(" "),a("p",[t._v("All patterns listed here have higher priority than stock watched and excluded lists supplied with Imunify360.")]),t._v(" "),a("div",{staticClass:"warning custom-block"},[a("p",{staticClass:"custom-block-title"},[t._v("IMPORTANT")]),a("p",[t._v("After making changes to this file, run the "),a("code",[t._v("imunify360-agent malware rebuild patterns")]),t._v(" command.")])]),a("p",[t._v("The "),a("span",{staticClass:"notranslate"},[a("code",[t._v("ignored.txt")])]),t._v(" file contains additional regular expression patterns specifying what filesystem paths should not be monitored by inotify/fanotify realtime scanner.")]),t._v(" "),a("p",[t._v("Patterns can be absolute:")]),t._v(" "),a("div",{staticClass:"notranslate"},[a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v("/another/folder\n")])])])]),t._v(" "),a("p",[t._v('or relative to basedirs supplied by hosting control panels, if they start with a "+" sign:"')]),t._v(" "),a("div",{staticClass:"notranslate"},[a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v("+[^/]+/www/\\.cache\n")])])])]),t._v(" "),a("p",[t._v("This relative pattern may expand to the "),a("span",{staticClass:"notranslate"},[a("code",[t._v("^/home/[^/]+/www/\\.cache")])]),t._v(" for cPanel, for example. The "),a("code",[t._v("+")]),t._v(" sign at the beginning is substituted with all base directories for user homes. Imunify360 picks up those directories from hosting panel configuration.")]),t._v(" "),a("p",[t._v("All patterns listed here have higher priority than stock watched and excluded lists supplied with Imunify360.")]),t._v(" "),a("p",[t._v("Custom exclude patterns have higher priority than custom watched patterns.")]),t._v(" "),a("div",{staticClass:"warning custom-block"},[a("p",{staticClass:"custom-block-title"},[t._v("IMPORTANT")]),a("p",[t._v("After making changes to this file, perform the "),a("span",{staticClass:"notranslate"},[a("code",[t._v("imunify360-agent malware rebuild patterns")])]),t._v(" command.")])]),a("h3",{attrs:{id:"_23-how-to-test-rules-based-on-modsecurity-tags"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_23-how-to-test-rules-based-on-modsecurity-tags","aria-hidden":"true"}},[t._v("#")]),t._v(" 23. How to test rules based on ModSecurity tags?")]),t._v(" "),a("p",[t._v("You can use the following URIs to check what was activated.")]),t._v(" "),a("div",{staticClass:"notranslate"},[a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v("curl -k 'https://example.org/?tag_test=joomla_core'\n")])])])]),t._v(" "),a("p",[t._v("It will produce 403 only for sites with Joomla!.")]),t._v(" "),a("div",{staticClass:"notranslate"},[a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v("curl -k 'https://example.org/?tag_test=wp_core'\n")])])])]),t._v(" "),a("p",[t._v("It will produce 403 only for sites with WordPress.")]),t._v(" "),a("h3",{attrs:{id:"_24-imunify-agent-is-not-running-troubleshooting"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_24-imunify-agent-is-not-running-troubleshooting","aria-hidden":"true"}},[t._v("#")]),t._v(' 24. "Imunify agent is not running" troubleshooting')]),t._v(" "),a("p",[t._v("Having the Imunify service installed, you may come across the situation when the message "),a("span",{staticClass:"notranslate"},[t._v('"Imunify agent is not running"')]),t._v(" is displayed when you try to access the Dashboard:")]),t._v(" "),a("p",[a("img",{attrs:{src:"/images/ImunifyAgentNotRunning.png",alt:""}})]),t._v(" "),a("p",[t._v("First of all, try to check the status of the service via the command line using the following command:")]),t._v(" "),a("div",{staticClass:"notranslate"},[a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v("# service imunify360 status\n")])])])]),t._v(" "),a("p",[t._v("In case you see the agent is inactive:")]),t._v(" "),a("div",{staticClass:"notranslate"},[a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v("[root@host ~]# service imunify360 status\n\n\nRedirecting to /bin/systemctl status imunify360.service\n● imunify360.service - Imunify360 agent\nLoaded: loaded (/usr/lib/systemd/system/imunify360.service; disabled; vendor preset: disabled)\nActive: inactive (dead)\n")])])])]),t._v(" "),a("p",[t._v("try to start it via the following command:")]),t._v(" "),a("div",{staticClass:"notranslate"},[a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v("# service imunify360 start\n")])])])]),t._v(" "),a("p",[t._v("It may also occur that despite the Imunify’s Dashboard showing the "),a("span",{staticClass:"notranslate"},[t._v('"agent is not running"')]),t._v(", the service itself is loaded and active.")]),t._v(" "),a("p",[t._v("You can check it with the following command:")]),t._v(" "),a("div",{staticClass:"notranslate"},[a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v("# service imunify360 status -l\n")])])])]),t._v(" "),a("p",[t._v("Example output:")]),t._v(" "),a("div",{staticClass:"notranslate"},[a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v('[root@host ~]# service imunify360 status -l\n\nRedirecting to /bin/systemctl status -l imunify360.service\n● imunify360.service - Imunify360 agent\nLoaded: loaded (/usr/lib/systemd/system/imunify360.service; enabled; vendor preset: disabled)\nActive: active (running) since Mon 2020-05-13 02:58:43 WIB; 3min 54s ago\nMain PID: 1234567 (python3)\nStatus: "Demonized"\nCGroup: /system.slice/imunify360.service\n├─1234567 /opt/alt/python35/bin/python3 -m im360.run --daemon --pidfile /var/run/imunify360.pid\n├─1234568 /usr/bin/tail --follow=name -n0 --retry /usr/local/cpanel/logs/cphulkd.log\n├─1234569 /usr/bin/tail --follow=name -n0 --retry /etc/apache2/logs/modsec_audit.log\n├─1234570 /usr/bin/tail --follow=name -n0 --retry /var/ossec/logs/alerts/alerts.json\n└─1234571 /opt/alt/python27/bin/python2.7 -s /usr/sbin/cagefsctl --wait-lock --force-update-etc\nMay 13 02:58:39 host.domain.com systemd[1]: Starting Imunify360 agent…\nMay 13 02:58:43 host.domain.com systemd[1]: Started Imunify360 agent.\nMay 13 02:58:43 host.domain.com imunify-service[4072717]: Starting migrations\nMay 13 02:58:43 host.domain.com imunify-service[4072717]: There is nothing to migrate\n')])])])]),t._v(" "),a("p",[t._v("Most often, such circumstances attest that the Imunify service has been recently installed on the server. Sometimes, a desynchronization between the agent and the web interface may occur in such cases, and it can take a bit of time for the database to be integrated completely.")]),t._v(" "),a("p",[t._v("In case the issue is still the same after 60 minutes, you can try creating the backup of the Imunify files and do the service restart to force the sync process:")]),t._v(" "),a("div",{staticClass:"notranslate"},[a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v("# service imunify360 stop\n# mv /var/imunify360/files /var/imunify360/files_backup\n# service imunify360 start\n")])])])]),t._v(" "),a("p",[t._v("After these actions, wait until the files downloading and the migration process are complete – the agent will synchronize with the web interface and start working normally. You can monitor this process via")]),t._v(" "),a("div",{staticClass:"notranslate"},[a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v("# tail -f /var/log/imunify360/console.log\n")])])])]),t._v(" "),a("p",[t._v("Another similar workaround may be handy in case you locate some database-related error inside the "),a("span",{staticClass:"notranslate"},[a("code",[t._v("/var/log/imunify360/error.log")])]),t._v(" – by renaming the database file and restarting the service. There may be errors like")]),t._v(" "),a("div",{staticClass:"notranslate"},[a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v('"Imunify360 database is corrupt. Application cannot run with corrupt database."\n')])])])]),t._v(" "),a("p",[t._v("or some lines with")]),t._v(" "),a("div",{staticClass:"notranslate"},[a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v('"sqlite3.DatabaseError".\n')])])])]),t._v(" "),a("p",[t._v("The "),a("code",[t._v("imunify360.db")]),t._v(" file is an sqlite3 database the Imunify360 relies on; it contains incidents, malware hits/lists, settings, etc. Using this workaround will force the database recreation:")]),t._v(" "),a("div",{staticClass:"notranslate"},[a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v("# service imunify360 stop\n# mv /var/imunify360/imunify360.db /var/imunify360/imunify360.db_backup\n# service imunify360 start\n")])])])]),t._v(" "),a("p",[t._v("If you face any difficulties during the progress or simply cannot make the agent start, please run")]),t._v(" "),a("div",{staticClass:"notranslate"},[a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v("# imunify360-agent doctor\n")])])])]),t._v(" "),a("p",[t._v("and provide the output to our Support Team at "),a("a",{attrs:{href:"https://cloudlinux.zendesk.com/hc/requests/new",target:"_blank",rel:"noopener noreferrer"}},[t._v("https://cloudlinux.zendesk.com/hc/requests/new"),a("OutboundLink")],1),t._v(".")]),t._v(" "),a("p",[t._v("You can find the ImunifyAV(+) instructions "),a("a",{attrs:{href:"https://docs.imunifyav.com/faq_and_known_issues/#imunify-agent-is-not-running-troubleshooting",target:"_blank",rel:"noopener noreferrer"}},[t._v("here"),a("OutboundLink")],1),t._v(".")]),t._v(" "),a("h2",{attrs:{id:"corner-cases"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#corner-cases","aria-hidden":"true"}},[t._v("#")]),t._v(" Corner cases")]),t._v(" "),a("h3",{attrs:{id:"ip-whitelisting-port-blocking-precedence"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#ip-whitelisting-port-blocking-precedence","aria-hidden":"true"}},[t._v("#")]),t._v(" IP whitelisting/port blocking precedence")]),t._v(" "),a("p",[t._v("Imunify360 has a corner case related to the following behavior of the Imunify360 firewall: when some IP is whitelisted and at the same time a certain port is blocked, the access to the port for the whitelisted IP is blocked (the port setting takes precedence).")]),t._v(" "),a("p",[a("img",{attrs:{src:"/images/corner1.jpg",alt:""}}),t._v(" "),a("img",{attrs:{src:"/images/corner2.jpg",alt:""}})]),t._v(" "),a("p",[t._v('As a workaround, you may add the IP address to "Whitelisted IP" list for the blocked port:')]),t._v(" "),a("p",[a("img",{attrs:{src:"/images/corner3.jpg",alt:""}})]),t._v(" "),a("p",[t._v("If you wish to use CLI -  you may remove the blocked port for all IPs and add a new record with the list of whitelisted IPs. Here's an example for TCP port 2083:")]),t._v(" "),a("div",{staticClass:"notranslate"},[a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v("imunify360-agent blocked-port delete 2083:tcp\nimunify360-agent blocked-port add  2083:tcp --ips 69.175.3.6  10.102.1.37\n")])])])]),t._v(" "),a("h2",{attrs:{id:"plesk-related"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#plesk-related","aria-hidden":"true"}},[t._v("#")]),t._v(" Plesk related")]),t._v(" "),a("h3",{attrs:{id:"how-to-get-an-imunify-activation-key-from-the-extended-plesk-license"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#how-to-get-an-imunify-activation-key-from-the-extended-plesk-license","aria-hidden":"true"}},[t._v("#")]),t._v(" How to get an Imunify activation key from the extended Plesk license")]),t._v(" "),a("p",[t._v("Often our clients purchase Imunify licenses through Plesk/Odin and in such cases, they get a universal key which includes the Imunify license and other additional keys for Plesk plugins. Such a key has the following syntax – "),a("code",[t._v("A00B00-0CDE00-F0G000-HIGK00-LM0N00")]),t._v(", – and initially, it is installed through Plesk automatically and the license gets activated successfully.")]),t._v(" "),a("p",[t._v("However, if it is required to re-register the agent for some reason or simply get the Imunify activation key separately, it would be impossible to apply the above-mentioned one – we would need to deal with the Imunify service separately.")]),t._v(" "),a("p",[t._v("To get the Imunify360 activation key from the extended Plesk license key, you will need to proceed with the following.")]),t._v(" "),a("ol",[a("li",[t._v("Navigate to "),a("span",{staticClass:"notranslate"},[a("em",[t._v("Tools & Settings >> Plesk >> License Management >> Additional License Keys")])])])]),t._v(" "),a("p",[a("img",{attrs:{src:"/images/LicenseManagement.png",alt:""}})]),t._v(" "),a("p",[a("img",{attrs:{src:"/images/AdditionalLicenseKeys.png",alt:""}})]),t._v(" "),a("ol",{attrs:{start:"2"}},[a("li",[a("p",[t._v("Click "),a("span",{staticClass:"notranslate"},[a("em",[t._v("Download key")])]),t._v(" next to the Imunify license listed on the page and open the file downloaded in some text editor")])]),t._v(" "),a("li",[a("p",[t._v("Find the following abstract:")])])]),t._v(" "),a("div",{staticClass:"notranslate"},[a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v('\x3c!--Key body--\x3e\n<aps-3:key-body core:encoding="base64" core:type="binary">YOUR_BASE64_ENCODED_LICENSE_KEY==</aps-3:key-body>\n\x3c!--Information about additional key--\x3e\n')])])])]),t._v(" "),a("ol",{attrs:{start:"4"}},[a("li",[a("p",[t._v("This is your base64-encoded key, and it should be decoded using a CLI utility or an online base64 decoder into UTF-8, e.g. "),a("a",{attrs:{href:"https://www.base64decode.org",target:"_blank",rel:"noopener noreferrer"}},[t._v("https://www.base64decode.org"),a("OutboundLink")],1),t._v(".\nThe new license key should have the following format: "),a("code",[t._v("IMxxxxxxxxxxxxxxx")]),t._v(".")])]),t._v(" "),a("li",[a("p",[t._v("Use the new key decoded to activate the service:")])])]),t._v(" "),a("div",{staticClass:"notranslate"},[a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v("# imunify360-agent register DECODED_KEY_HERE\n")])])])]),t._v(" "),a("p",[t._v("This is it!")]),t._v(" "),a("Disqus")],1)},[],!1,null,null,null);e.default=n.exports}}]);